<!-- src/app/movies/movie-form/movie-form.html -->
<div class="container py-4">

  <a routerLink="/movies" class="btn btn-outline-secondary btn-sm mb-3">
    <i class="bi bi-arrow-left"></i> Volver al catálogo
  </a>

  <div class="card bg-dark text-light border-0 shadow-sm">
    <div class="card-header bg-transparent border-0 pb-0">
      <h3 class="mb-0">{{ isEdit() ? 'Editar película' : 'Nueva película' }}</h3>
      <small class="text-secondary">Completa los campos y guarda los cambios.</small>
    </div>

    <form [formGroup]="form" (ngSubmit)="save()" class="card-body">
      <div class="row g-3">

        <!-- Título -->
        <div class="col-12 col-md-8">
          <label class="form-label">Título</label>
          <input type="text"
                 class="form-control"
                 [ngClass]="{ 'is-invalid': f.title.touched && f.title.invalid }"
                 formControlName="title"
                 placeholder="Ej. Hellboy" />
          <div class="invalid-feedback" *ngIf="f.title.touched && f.title.errors">
            <ng-container *ngIf="f.title.errors['required']">El título es obligatorio.</ng-container>
            <ng-container *ngIf="f.title.errors['maxlength']">Máximo 255 caracteres.</ng-container>
          </div>
        </div>

        <!-- Año -->
        <div class="col-12 col-md-4">
          <label class="form-label">Año</label>
          <div class="input-group has-validation">
            <span class="input-group-text"><i class="bi bi-calendar-event"></i></span>
            <input type="number"
                   class="form-control"
                   [ngClass]="{ 'is-invalid': f.year.touched && f.year.invalid }"
                   formControlName="year"
                   placeholder="2024" />
            <div class="invalid-feedback" *ngIf="f.year.touched && f.year.errors">
              <ng-container *ngIf="f.year.errors['required']">Campo obligatorio.</ng-container>
              <ng-container *ngIf="f.year.errors['min']">Mínimo 1888.</ng-container>
              <ng-container *ngIf="f.year.errors['max']">Máximo 2100.</ng-container>
            </div>
          </div>
        </div>

        <!-- Cover -->
        <div class="col-12">
          <label class="form-label">URL de portada (opcional)</label>
          <input type="url"
                 class="form-control"
                 formControlName="cover"
                 placeholder="https://.../poster.jpg" />
          <div class="form-text text-secondary">
            URL válida (imagen del póster).
          </div>
        </div>

        <!-- Sinopsis -->
        <div class="col-12">
          <label class="form-label">Sinopsis</label>
          <textarea rows="5"
                    class="form-control"
                    formControlName="synopsis"
                    placeholder="Cuenta de qué va la película..."></textarea>
          <div class="form-text text-secondary">
            Descripcion de sinopsis
          </div>
        </div>
      </div>

      <!-- Botonera -->
      <div class="d-flex gap-2 mt-4">
        <button class="btn btn-gradient-primary" type="submit" [disabled]="loading() || form.invalid">
          <i class="bi bi-save me-1"></i>
          <span *ngIf="!loading()">Guardar</span>
          <span *ngIf="loading()">Guardando…</span>
        </button>

        <a routerLink="/movies" class="btn btn-outline-secondary">Cancelar</a>

        <button *ngIf="isEdit()"
                class="btn btn-outline-danger ms-auto"
                type="button"
                (click)="remove()"
                [disabled]="loading()">
          <i class="bi bi-trash me-1"></i> Eliminar
        </button>
      </div>
    </form>
  </div>
</div>
